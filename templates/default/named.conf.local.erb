//
// Do any local configuration here
//

// Consider adding the 1918 zones here, if they are not used in your
// organization
//include "/etc/bind/zones.rfc1918";

<% @zonefiles.each do |conf| -%>
  <% if conf['type'] %>
zone "<%= conf['domain'] %>" {
  type <%= conf['type'] %>;
    <% if conf['type'] == "master" %>
  file "<%= node[:bind9][:zones_path] %>/db.<%= conf["domain"] %>";
      <% if conf['allow_transfer'].is_a?(Array) %>
  allow-transfer {
        <% conf['allow_transfer'].each do |ip| -%>
    <%= ip %>;
        <% end %>
  };
      <% end %>
      <% if conf['also_notify'].is_a?(Array) -%>
  also-notify {
        <% conf['also_notify'].each do |ip| -%> 
    <%= ip %>;
        <% end %>
  };
      <% end %>
    <% elsif conf['type'] == "slave" -%>
  file "db.<%= conf["domain"] %>";
  masters {
      <% conf['masters'].each do |ip| -%>
    <%= ip %>;
      <% end %>
  };
    <% end %>
};

  <% end %>
<% end %>
